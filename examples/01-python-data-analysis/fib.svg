<svg xmlns="http://www.w3.org/2000/svg">
  <script type="text/wasm" src="calculations.wasm"><![CDATA[
    (module
      (func $fibonacci (param $n i32) (result i32)
        (if (i32.lt_s (local.get $n) (i32.const 2))
          (then (return (local.get $n)))
        )
        (return (i32.add
          (call $fibonacci (i32.sub (local.get $n) (i32.const 1)))
          (call $fibonacci (i32.sub (local.get $n) (i32.const 2)))
        ))
      )
      (export "fibonacci" (func $fibonacci))
    )
  ]]></script>

  <script><![CDATA[
    // WywoÅ‚anie funkcji WASM
    window.addEventListener('load', async function() {
        try {
            const wasmModule = await WebAssembly.instantiateStreaming(fetch('calculations.wasm'));
            window.wasmModule = wasmModule.instance;
            const result = wasmModule.instance.exports.fibonacci(10);
            document.getElementById("result").textContent = result;
        } catch (error) {
            console.error('WASM initialization failed:', error);
            const errorText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            errorText.textContent = 'Error: WASM initialization failed - ' + error.message;
            errorText.setAttribute('x', '20');
            errorText.setAttribute('y', '70');
            document.getElementsByTagName('svg')[0].appendChild(errorText);
        }
    });
    ]]></script>

  <text id="result" x="50" y="50">Loading...</text>
</svg>